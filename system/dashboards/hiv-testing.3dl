<TabSet>

    <Tab title="HIV Testing">
        <Dashboard>
            <Grid>
                <Row>
                    <Header>ART Cascade Tree</Header>
                </Row>
                <Filters>
                    <Filter caption="Reporting Week" name="week" values_query={`SELECT DISTINCT weekly_start_monday_day_dates, weekly_start_monday_end_date FROM derived.dim_date ORDER BY weekly_start_monday_end_date DESC;`}/>
                </Filters>
                <Row columns = "2" largeColumns = "4">

                    <Dataset query={`SELECT SUM(is_valid_hiv_test) FROM derived.fact_hiv_testing f;`}>
                        <Tile title="HTS TST"/>
                    </Dataset>

                    <Dataset query={`SELECT SUM(is_hiv_negative) FROM derived.fact_hiv_testing f;`}>
                        <Tile title="HTS TST NEG"/>
                    </Dataset>

                    <Dataset query={`SELECT SUM(is_hiv_positive) FROM derived.fact_hiv_testing f;`}>
                        <Tile title="HTS TST POS">
                          <Dataset query='SELECT f.hts_client_code AS "HTS Client Code", hts_age_at_test AS Age, hts_sex_code AS Sex, hiv_test_date AS "HIV Test Date", hiv_testing_point AS "HIV Testing Point", hts_attendance_type AS "HTS Attendance Type", hts_date_of_birth AS DOB FROM derived.fact_hiv_testing f INNER JOIN derived.dim_hts_client c ON f.hts_client_id = c.hts_client_id WHERE is_hiv_positive = 1;'>
                            <InfiniteScrollTable header='HIV Positive Clients' variant='plain' />
                          </Dataset>
                        </Tile>
                      </Dataset>

                    <Dataset query={`SELECT ISNULL(SUM(is_hiv_positive), 0) FROM derived.fact_hiv_testing f WHERE hts_ctc_id IS NOT NULL;`}>
                        <Tile title="HTS TST POS">
                            <Dataset query='SELECT f.hts_client_code AS "HTS Client Code", hts_age_at_test AS Age, hts_sex_code AS Sex, hiv_test_date AS "HIV Test Date", hiv_testing_point AS "HIV Testing Point", hts_attendance_type AS "HTS Attendance Type", hts_ctc_id AS "CTC ID" FROM derived.fact_hiv_testing f INNER JOIN derived.dim_hts_client c ON f.hts_client_id = c.hts_client_id WHERE is_hiv_positive = 1 AND hts_ctc_id IS NOT NULL;'>
                              <InfiniteScrollTable header='HIV Positive Clients' variant='plain' />
                            </Dataset>
                          </Tile>
                        </Dataset>

                </Row>
                <Row columns="1">
                    <Dataset query="">
                      <CascadeChart
                        header="HIV Testing Tree"
                        subHeader="HIV Testing Tree"
                        cascadeObject={{
                          id: "1",
                          data: {
                            label: "Clients Tested for HIV",
                            query:
                              "SELECT hts_date_of_birth, hts_age_at_test, hts_sex_code, f.hts_client_code, hiv_test_date, hiv_testing_point, hts_attendance_type, hts_referred_from, hts_ctc_id FROM derived.fact_hiv_testing f INNER JOIN derived.dim_hts_client c ON f.hts_client_id = c.hts_client_id WHERE is_valid_hiv_test = 1;",
                          },
                          options: {
                              nodeBGColorHover: "#007bff",
                              borderColorHover: "#0056b3",
                              nodeBGColor: "#d1ecf1",
                          },
                          children: [
                            {
                                id: "11",
                                data: {
                                    label: "Clients Tested Positive",
                                    query:
                                    "SELECT hts_date_of_birth, hts_age_at_test, hts_sex_code, f.hts_client_code, hiv_test_date, hiv_testing_point, hts_attendance_type, hts_referred_from, hts_ctc_id FROM derived.fact_hiv_testing f INNER JOIN derived.dim_hts_client c ON f.hts_client_id = c.hts_client_id WHERE is_hiv_positive = 1;",
                                },
                                children: [
                                {
                                    id: "111",
                                    data: {
                                        label: "With Documented CTC ID",
                                        query:
                                        "SELECT hts_date_of_birth, hts_age_at_test, hts_sex_code, f.hts_client_code, hiv_test_date, hiv_testing_point, hts_attendance_type, hts_referred_from, hts_ctc_id FROM derived.fact_hiv_testing f INNER JOIN derived.dim_hts_client c ON f.hts_client_id = c.hts_client_id WHERE is_hiv_positive = 1;",
                                    },
                                    options: {
                                        nodeBGColorHover: "#28a745",
                                        borderColorHover: "#218838",
                                        nodeBGColor: "#c3e6cb",
                                    },
                                },
                                {
                                    id: "112",
                                    data: {
                                        label: "Without Documented CTC ID",
                                        query:
                                        "SELECT hts_date_of_birth, hts_age_at_test, hts_sex_code, f.hts_client_code, hiv_test_date, hiv_testing_point, hts_attendance_type, hts_referred_from, hts_ctc_id FROM derived.fact_hiv_testing f INNER JOIN derived.dim_hts_client c ON f.hts_client_id = c.hts_client_id WHERE is_hiv_positive = 1;",
                                    },
                                    options: {
                                        nodeBGColorHover: "#ffc107",
                                        borderColorHover: "#e0a800",
                                        nodeBGColor: "#ffeeba",
                                    },
                                },
                                ],
                            },
                            {
                                id: "12",
                                data: {
                                    label: "Clients Tested Negative",
                                    query:
                                    "SELECT hts_date_of_birth, hts_age_at_test, hts_sex_code, f.hts_client_code, hiv_test_date, hiv_testing_point, hts_attendance_type, hts_referred_from, hts_ctc_id FROM derived.fact_hiv_testing f INNER JOIN derived.dim_hts_client c ON f.hts_client_id = c.hts_client_id WHERE is_hiv_negative = 1;",
                                },
                                options: {
                                    nodeBGColorHover: "#dc3545",
                                    borderColorHover: "#c82333",
                                    nodeBGColor: "#f8d7da",
                              },
                            },
                          ],
                        }}
                      />
                    </Dataset>
                  </Row>
            </Grid>
        </Dashboard>
    </Tab>

</TabSet>